{{ 'cart.scss' | asset_url | stylesheet_tag }}
{% if cart.item_count > 0 %}
<div class="container">
  <div class="heading">
  <h1>KOSZYK</h1>
  </div>
  <form action="/cart" method="post" novalidate>
    {% for item in cart.items %}
    <table>
      <thead>
        <tr>
          <td rowspan="4">
            <a href="{{ item.url | within: collections.all }}">
              <div class="cart-product-img">
                <img src="{{ item | img_url: 'medium' }}" alt="{{ item.title | escape }}">
              </div>
            </a>
          </td>
          <td>
            <div class="cart-product-title">
              <a href="{{ item.url }}">{{ item.product.title }}</a>
            </div>
          </td>
        </tr>
        <tr>
          <td>
            <div class="cart-product-variant">
            {% if item contains variant %}
              {{ item.variant.title }}
              {%endif%}
            </div>
          </td>
        </tr>
        <tr>
          <td>
            <div class="cart-product-price">
            {{ item.price | money }}
            </div>
          </td>
        </tr>
        <tr>
          <td>
            <div class="quantity-and-remove">
              <div class="quantity-wrapper">
                <button type="submit" name="update" class="minus">-</button>
                  <div class="quant"><input type="number" name="updates[]" id="updates_{{ item.key }}" class="updates" value="{{ item.quantity }}" min="0"></div>
                <button type="submit" name="update" class="plus">+</button>
              </div>
              <a href="/cart/change?line={{ forloop.index }}&amp;quantity=0">USUŃ</a>
            </div>
          </td>
        </tr>
      </thead>
    </table>
    {% endfor %}
    <div>
     
      <div class="sum">
        <span>PRODUKTY</span>
        <span id="total">{{ cart.total_price | money }}</span>
      </div>
      <div class="send">
        <span>WYSYŁKA</span>
          {% if cart.total_price >= 50000 | money %}
          <span>{{ '0' | money }}</span>
          {% else %}
          <span>{{ '2000' | money }}</span><br>
          <span>Brakuje {{ cart.total_price | minus: 50000 | times: -1 | money }} do darmowej wysyłki</span>
          {%endif%}
      </div>
      <div class="gift">
        <label for="gift">
        <input type="checkbox" id="gift" name="gift" onclick="check()">Pakowanie na prezent
        </label>
        <div class="span">+ 15 zł</div>
        <script>
          const giftCheckbox = document.getElementById('gift')
          const total=document.getElementById('total')
          function check(){
          if(giftCheckbox.checked==1){
            total.innerHTML="{{ cart.total_price | plus: 1500 | money }}"
          }
          else 
            total.innerHTML="{{ cart.total_price | money }}"
          }


          const minusBtn=document.querySelector('.minus')
          const plusBtn=document.querySelector('.plus')
          const quantity=document.querySelector('.updates')

          minusBtn.addEventListener('click', ()=> {
            if(quantity.value>=2){
              quantity.value-=1
            }
            else return
          })
          plusBtn.addEventListener('click', ()=> {
            quantity.value++
            
          })
        </script>
      </div>
      <button type="submit" name="update">Update</button>
      <button type="submit" name="checkout">Checkout</button>
    </div>
  </form>
{% else %}
  <h2>cart</h2>
  Cart is empty
{% endif %}
</div>
